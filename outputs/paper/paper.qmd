---
title: "Lifespans of Prime Ministers of Canada"
author: 
  - Irene Huynh
thanks: "Code is available at: https://github.com/IreneeeH/STA302_Mini-Essay_5a.git"
date: today
date-format: long
format: pdf
number-sections: true
bibliography: references.bib
---

```{r}
#| include: false
#| warning: false
#| message: false

#### Workspace set-up ####
library(tidyverse)
library(knitr)
library(dplyr)
library(babynames)
library(pdftools)
library(rvest)
library(xml2)
library(janitor)
library(here)
```

# Planning, Gathering, and Cleaning Sources

The statistical programming language R was used to retrieve, clean, and process the data [@citeR]. In particular, the following R packages were used: tidyverse [@tidyverse], rvest [], and xml2 [] for data acquisition, knitr [@knitr], janitor [], dplyr [], and here [] for data cleaning and processing, and ggplot2 [@ggplot2] for creating figures.

# Planning

A simulation of the expected data set is found below, having the Prime Minister's name, their birth year, death year, and years lived as columns. The simulation was created using the following R packages: tidyverse [], babynames [], and pdftools [].
```{r}
#| echo: false
#| warning: false
#| message: false

set.seed(853)

simulated_dataset <-
  tibble(
    prime_minister = babynames |>
      filter(prop > 0.01) |>
      distinct(name) |>
      unlist() |>
      sample(size = 10, replace = FALSE),
    birth_year = sample(1700:1990, size = 10, replace = TRUE),
    years_lived = sample(50:100, size = 10, replace = TRUE),
    death_year = birth_year + years_lived
  ) |>
  select(prime_minister, birth_year, death_year, years_lived) |>
  arrange(birth_year)

simulated_dataset
```

A sketch of the expected graph can be found below:

```{r}
#| echo: false
#| warning: false
#| message: false

# knitr::include_graphics("graph_sketch.pdf")
```

# Gathering

The data utilized in this paper was retrieved from a Wikipedia page of the List of Prime Ministers of Canada [] using the rvest R package [].

There is another element in pms.html with a wikitable class that precedes the desired table of Prime Ministers of Canada. This caused html_element(".wikitable") to use that table instead of the desired one. To resolve this issue, I went into pms.html and removed the wikitable class from that table. Now, html_element(".wikitable") should be able to identify the correct wikitable.

# Cleaning
While using the original code provided in Telling Stories With Data - 7 Gather data [], cleaning the data was difficult as the birth dates of Prime Ministers who are still alive did not appear. After some trial and error, I realized that the "born" attribute must be manipulated. Additionally, the finalized cleaned_data included a final row with extra information from the html file. To remove this, I had to filter it out.

```{r}
#| label: fig-primeministerslifespan
#| fig-cap: "The lifespan of all Prime Ministers of Canada"
#| echo: false
#| warning: false
#| message: false


# Read in the cleaned data
cleaned_data <-
  read_csv(
    file = here("outputs/data/cleaned_data.csv"),
    show_col_types = FALSE
  )

cleaned_data |>
  mutate(
    still_alive = if_else(is.na(died), "Yes", "No"),
    died = if_else(is.na(died), as.integer(2023), died)
  ) |>
  mutate(name = as_factor(name)) |>
  ggplot(
    aes(x = born, xend = died, y = name, yend = name, color = still_alive)
    ) +
  geom_segment() +
  labs(
    x = "Year of birth", y = "Prime minister", color = "PM is currently alive"
    ) +
  theme_minimal() +
  scale_color_brewer(palette = "Set1") +
  theme(legend.position = "bottom")
```

# Results
Figure 1 reveals that John Thompson had the shortest lifespan, Additionally, 7 Prime Ministers are still alive. 

# Results {#sec-data}

\newpage

# References

